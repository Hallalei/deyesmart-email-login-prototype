<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>DeyeSmart - Login</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    * {
      font-family: -apple-system, BlinkMacSystemFont, 'Inter', 'Segoe UI', Roboto, sans-serif;
      -webkit-tap-highlight-color: transparent;
    }

    /* iPhone frame container */
    .phone-frame {
      width: 375px;
      height: 812px;
      background: linear-gradient(180deg, #E8F4FD 0%, #F5E6D3 50%, #FFFFFF 100%);
      position: relative;
      overflow: hidden;
      border-radius: 40px;
      box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
    }

    /* Page container */
    .page {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease, transform 0.3s ease;
      transform: translateX(20px);
    }

    .page.active {
      opacity: 1;
      pointer-events: auto;
      transform: translateX(0);
    }

    /* Status bar */
    .status-bar {
      height: 44px;
      padding: 14px 24px 0;
      display: flex;
      justify-content: space-between;
      align-items: center;
      color: #333;
      font-size: 14px;
      font-weight: 600;
    }

    /* Logo animation */
    .logo-cloud {
      animation: float 3s ease-in-out infinite;
    }

    @keyframes float {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-5px); }
    }

    /* Card styling */
    .auth-card {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(20px);
      border-radius: 24px 24px 0 0;
      box-shadow: 0 -10px 40px rgba(0, 0, 0, 0.1);
    }

    /* Input styling */
    .input-field {
      background: #F5F7FA;
      border: 1.5px solid transparent;
      border-radius: 12px;
      padding: 14px 16px;
      font-size: 16px;
      width: 100%;
      transition: all 0.2s ease;
      outline: none;
    }

    .input-field:focus {
      background: #FFFFFF;
      border-color: #4A90E2;
      box-shadow: 0 0 0 4px rgba(74, 144, 226, 0.1);
    }

    .input-field::placeholder {
      color: #9CA3AF;
    }

    /* Button styling */
    .btn-primary {
      background: linear-gradient(135deg, #5BA0F5 0%, #4A90E2 100%);
      color: white;
      border: none;
      border-radius: 24px;
      padding: 16px 32px;
      font-size: 16px;
      font-weight: 600;
      width: 100%;
      cursor: pointer;
      transition: all 0.2s ease;
      box-shadow: 0 4px 15px rgba(74, 144, 226, 0.3);
    }

    .btn-primary:hover {
      transform: translateY(-1px);
      box-shadow: 0 6px 20px rgba(74, 144, 226, 0.4);
    }

    .btn-primary:active {
      transform: translateY(0);
    }

    .btn-primary:disabled {
      background: #CBD5E1;
      box-shadow: none;
      cursor: not-allowed;
    }

    /* Social buttons */
    .social-btn {
      width: 56px;
      height: 56px;
      border-radius: 50%;
      border: 1.5px solid #E5E7EB;
      background: white;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .social-btn:hover {
      border-color: #4A90E2;
      transform: scale(1.05);
    }

    /* Password strength indicator */
    .strength-bar {
      height: 4px;
      border-radius: 2px;
      background: #E5E7EB;
      overflow: hidden;
    }

    .strength-fill {
      height: 100%;
      transition: all 0.3s ease;
      border-radius: 2px;
    }

    /* Checkbox styling */
    .custom-checkbox {
      width: 20px;
      height: 20px;
      border: 2px solid #D1D5DB;
      border-radius: 4px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s ease;
      flex-shrink: 0;
    }

    .custom-checkbox.checked {
      background: #4A90E2;
      border-color: #4A90E2;
    }

    .custom-checkbox.checked svg {
      display: block;
    }

    .custom-checkbox svg {
      display: none;
      width: 12px;
      height: 12px;
      color: white;
    }

    /* Verification code input */
    .code-input {
      width: 45px;
      height: 52px;
      text-align: center;
      font-size: 24px;
      font-weight: 600;
      border: 2px solid #E5E7EB;
      border-radius: 12px;
      outline: none;
      transition: all 0.2s ease;
    }

    .code-input:focus {
      border-color: #4A90E2;
      box-shadow: 0 0 0 4px rgba(74, 144, 226, 0.1);
    }

    /* Back button */
    .back-btn {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.9);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s ease;
      border: none;
    }

    .back-btn:hover {
      background: white;
      transform: scale(1.05);
    }

    /* Modal overlay */
    .modal-overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      display: none;
      align-items: flex-end;
      z-index: 100;
    }

    .modal-overlay.active {
      display: flex;
    }

    .modal-content {
      background: white;
      width: 100%;
      max-height: 80%;
      border-radius: 24px 24px 0 0;
      overflow: hidden;
      animation: slideUp 0.3s ease;
    }

    @keyframes slideUp {
      from {
        transform: translateY(100%);
      }
      to {
        transform: translateY(0);
      }
    }

    /* Scrollbar styling */
    ::-webkit-scrollbar {
      width: 4px;
    }

    ::-webkit-scrollbar-track {
      background: #F1F1F1;
    }

    ::-webkit-scrollbar-thumb {
      background: #C1C1C1;
      border-radius: 2px;
    }

    /* ==================== Soft Tech 边界流程增强样式 ==================== */

    /* 输入框错误状态 - 带脉冲光晕 */
    .input-field.error {
      border-color: #F87171 !important;
      background: linear-gradient(135deg, #FEF2F2 0%, #FFFFFF 100%);
      animation: errorPulse 2s ease-in-out infinite;
    }

    .input-field.error:focus {
      box-shadow: 0 0 0 4px rgba(248, 113, 113, 0.15), 0 4px 12px rgba(248, 113, 113, 0.1);
    }

    @keyframes errorPulse {
      0%, 100% { box-shadow: 0 0 0 0 rgba(248, 113, 113, 0); }
      50% { box-shadow: 0 0 0 4px rgba(248, 113, 113, 0.1); }
    }

    .input-field.success {
      border-color: #34D399 !important;
      background: linear-gradient(135deg, #ECFDF5 0%, #FFFFFF 100%);
    }

    .input-field.success:focus {
      box-shadow: 0 0 0 4px rgba(52, 211, 153, 0.15);
    }

    /* 验证码输入错误状态 - 弹性抖动 */
    .code-input.error {
      border-color: #F87171 !important;
      background: linear-gradient(135deg, #FEF2F2 0%, #FFFFFF 100%);
      animation: elasticShake 0.6s cubic-bezier(0.36, 0.07, 0.19, 0.97) both;
    }

    /* 弹性抖动动画 */
    @keyframes elasticShake {
      0% { transform: translateX(0); }
      15% { transform: translateX(-12px); }
      30% { transform: translateX(10px); }
      45% { transform: translateX(-8px); }
      60% { transform: translateX(6px); }
      75% { transform: translateX(-4px); }
      90% { transform: translateX(2px); }
      100% { transform: translateX(0); }
    }

    /* 错误提示文字 - 带图标动画 */
    .error-message {
      color: #DC2626;
      font-size: 12px;
      margin-top: 6px;
      display: flex;
      align-items: center;
      gap: 6px;
      animation: errorFadeIn 0.3s ease-out;
    }

    .error-message svg {
      width: 14px;
      height: 14px;
      flex-shrink: 0;
      animation: errorIconPop 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    }

    @keyframes errorFadeIn {
      from { opacity: 0; transform: translateY(-4px); }
      to { opacity: 1; transform: translateY(0); }
    }

    @keyframes errorIconPop {
      0% { transform: scale(0); }
      70% { transform: scale(1.2); }
      100% { transform: scale(1); }
    }

    /* 成功提示文字 */
    .success-message {
      color: #059669;
      font-size: 12px;
      margin-top: 6px;
      display: flex;
      align-items: center;
      gap: 6px;
      animation: successFadeIn 0.3s ease-out;
    }

    .success-message svg {
      width: 14px;
      height: 14px;
      flex-shrink: 0;
      animation: successCheck 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    }

    @keyframes successFadeIn {
      from { opacity: 0; transform: translateY(-4px); }
      to { opacity: 1; transform: translateY(0); }
    }

    @keyframes successCheck {
      0% { transform: scale(0) rotate(-45deg); }
      70% { transform: scale(1.2) rotate(0deg); }
      100% { transform: scale(1) rotate(0deg); }
    }

    /* Toast 提示组件 - 磨砂玻璃效果 */
    .toast-container {
      position: absolute;
      top: 56px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 200;
      width: 92%;
      max-width: 340px;
      pointer-events: none;
    }

    .toast {
      padding: 14px 18px;
      border-radius: 16px;
      font-size: 14px;
      font-weight: 500;
      display: flex;
      align-items: center;
      gap: 12px;
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.12), 0 2px 8px rgba(0, 0, 0, 0.08);
      pointer-events: auto;
      opacity: 0;
      transform: translateY(-20px) scale(0.95);
      transition: none;
    }

    .toast.show {
      animation: toastEnter 0.4s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
    }

    .toast.hide {
      animation: toastExit 0.3s ease-in forwards;
    }

    .toast svg {
      width: 22px;
      height: 22px;
      flex-shrink: 0;
    }

    .toast.success {
      background: rgba(236, 253, 245, 0.92);
      color: #065F46;
      border: 1px solid rgba(167, 243, 208, 0.6);
    }

    .toast.success svg {
      color: #10B981;
    }

    .toast.error {
      background: rgba(254, 242, 242, 0.92);
      color: #991B1B;
      border: 1px solid rgba(254, 202, 202, 0.6);
    }

    .toast.error svg {
      color: #EF4444;
    }

    .toast.warning {
      background: rgba(255, 251, 235, 0.92);
      color: #92400E;
      border: 1px solid rgba(253, 230, 138, 0.6);
    }

    .toast.warning svg {
      color: #F59E0B;
    }

    .toast.info {
      background: rgba(239, 246, 255, 0.92);
      color: #1E40AF;
      border: 1px solid rgba(191, 219, 254, 0.6);
    }

    .toast.info svg {
      color: #3B82F6;
    }

    @keyframes toastEnter {
      0% {
        opacity: 0;
        transform: translateY(-20px) scale(0.95);
      }
      100% {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }

    @keyframes toastExit {
      0% {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
      100% {
        opacity: 0;
        transform: translateY(-16px) scale(0.95);
      }
    }

    /* 密码规则列表 - 带勾选动画 */
    .password-rules {
      margin-top: 10px;
      padding: 10px 12px;
      background: rgba(249, 250, 251, 0.8);
      border-radius: 10px;
    }

    .password-rule {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 12px;
      color: #9CA3AF;
      padding: 4px 0;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .password-rule .rule-icon {
      width: 16px;
      height: 16px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #E5E7EB;
      transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
    }

    .password-rule .rule-icon svg {
      width: 10px;
      height: 10px;
      opacity: 0;
      transform: scale(0);
      transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
    }

    .password-rule.valid {
      color: #059669;
    }

    .password-rule.valid .rule-icon {
      background: #10B981;
      transform: scale(1.1);
    }

    .password-rule.valid .rule-icon svg {
      opacity: 1;
      transform: scale(1);
      color: white;
    }

    /* 输入框容器 */
    .input-wrapper {
      position: relative;
    }

    /* 验证码输入增强 */
    .code-input-wrapper {
      position: relative;
    }

    .code-error-hint {
      position: absolute;
      left: 50%;
      transform: translateX(-50%);
      bottom: -24px;
      font-size: 12px;
      color: #DC2626;
      white-space: nowrap;
      animation: errorFadeIn 0.3s ease-out;
    }

    /* 确认密码匹配提示 */
    .password-match-hint {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 12px;
      margin-top: 6px;
      animation: errorFadeIn 0.3s ease-out;
    }

    .password-match-hint.match {
      color: #059669;
    }

    .password-match-hint.mismatch {
      color: #DC2626;
    }

    .password-match-hint svg {
      width: 14px;
      height: 14px;
    }
  </style>
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center p-4">

  <!-- iPhone Frame -->
  <div class="phone-frame" id="app">

    <!-- Toast Container -->
    <div class="toast-container" id="toast-container"></div>

    <!-- ==================== PAGE 1: LOGIN ==================== -->
    <div class="page active" id="page-login">
      <!-- Status Bar -->
      <div class="status-bar">
        <span>9:41</span>
        <div class="flex items-center gap-1">
          <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24"><path d="M12 3C7.5 3 4 5.5 4 9c0 5 8 12 8 12s8-7 8-12c0-3.5-3.5-6-8-6zm0 2c2.8 0 5 1.8 5 4 0 1.5-1 3.5-3 5.7L12 17l-2-2.3C8 12.5 7 10.5 7 9c0-2.2 2.2-4 5-4z"/></svg>
          <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24"><path d="M1 9l2 2c4.97-4.97 13.03-4.97 18 0l2-2C16.93 2.93 7.08 2.93 1 9zm8 8l3 3 3-3c-1.65-1.66-4.34-1.66-6 0zm-4-4l2 2c2.76-2.76 7.24-2.76 10 0l2-2C15.14 9.14 8.87 9.14 5 13z"/></svg>
          <svg class="w-6 h-4" fill="currentColor" viewBox="0 0 24 24"><rect x="2" y="7" width="18" height="10" rx="2" stroke="currentColor" stroke-width="2" fill="none"/><rect x="20" y="10" width="2" height="4" rx="1"/><rect x="4" y="9" width="12" height="6" rx="1"/></svg>
        </div>
      </div>

      <!-- Header Area -->
      <div class="px-6 pt-8 pb-4">
        <!-- Logo -->
        <div class="flex flex-col items-center">
          <div class="logo-cloud mb-3">
            <svg width="64" height="48" viewBox="0 0 64 48" fill="none">
              <path d="M52 24C52 13.5 43.5 5 33 5C24.5 5 17.5 10.5 15 18C7 19 1 25.5 1 33.5C1 42 8 48 16.5 48H50C57.5 48 63 42.5 63 35C63 28 58 22.5 52 24Z" fill="white" stroke="#4A90E2" stroke-width="2"/>
              <circle cx="48" cy="12" r="4" fill="#4A90E2" opacity="0.3"/>
              <circle cx="54" cy="8" r="2" fill="#4A90E2" opacity="0.5"/>
              <circle cx="44" cy="6" r="2" fill="#4A90E2" opacity="0.4"/>
            </svg>
          </div>
          <h1 class="text-2xl font-bold text-gray-800 mb-1">Open Smart Life</h1>
          <p class="text-gray-500 text-sm">Welcome to DeyeSmart</p>
        </div>
      </div>

      <!-- Auth Card -->
      <div class="auth-card absolute bottom-0 left-0 right-0 px-6 pt-8 pb-10">
        <!-- Form -->
        <div class="space-y-4">
          <!-- Email Input -->
          <div class="input-wrapper">
            <input type="email" class="input-field" placeholder="Email address" id="login-email" onblur="validateEmailField('login-email')">
            <div id="login-email-error"></div>
          </div>

          <!-- Password Input -->
          <div class="input-wrapper">
            <div class="relative">
              <input type="password" class="input-field pr-12" placeholder="Password" id="login-password">
              <button class="absolute right-4 top-1/2 -translate-y-1/2 text-gray-400" onclick="togglePassword('login-password', this)">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/>
              </svg>
            </button>
            </div>
          </div>

          <!-- Forgot Password -->
          <div class="text-right">
            <a href="#" class="text-sm text-blue-500 font-medium" onclick="goToForgotPassword()">Forgot password?</a>
          </div>

          <!-- Agreement Checkbox -->
          <div class="flex items-start gap-3">
            <div class="custom-checkbox" id="login-agree" onclick="toggleCheckbox(this)">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                <polyline points="20 6 9 17 4 12"></polyline>
              </svg>
            </div>
            <p class="text-xs text-gray-500 leading-relaxed">
              I have read and agree to the
              <a href="#" class="text-blue-500" onclick="showModal('terms-modal')">Terms of Service</a>
              and
              <a href="#" class="text-blue-500" onclick="showModal('privacy-modal')">Privacy Policy</a>
            </p>
          </div>

          <!-- Login Button -->
          <button class="btn-primary mt-2" onclick="handleLogin()">Sign In</button>

          <!-- Register Link -->
          <p class="text-center text-sm text-gray-500 mt-4">
            Don't have an account?
            <a href="#" class="text-blue-500 font-medium" onclick="showPage('page-register')">Sign Up</a>
          </p>
        </div>

        <!-- Social Login Divider -->
        <div class="flex items-center gap-4 my-6">
          <div class="flex-1 h-px bg-gray-200"></div>
          <span class="text-xs text-gray-400">or continue with</span>
          <div class="flex-1 h-px bg-gray-200"></div>
        </div>

        <!-- Social Buttons -->
        <div class="flex justify-center">
          <!-- Apple -->
          <button class="social-btn" onclick="handleSocialLogin('Apple')">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="#000">
              <path d="M17.05 20.28c-.98.95-2.05.8-3.08.35-1.09-.46-2.09-.48-3.24 0-1.44.62-2.2.44-3.06-.35C2.79 15.25 3.51 7.59 9.05 7.31c1.35.07 2.29.74 3.08.8 1.18-.24 2.31-.93 3.57-.84 1.51.12 2.65.72 3.4 1.8-3.12 1.87-2.38 5.98.48 7.13-.57 1.5-1.31 2.99-2.54 4.09l.01-.01zM12.03 7.25c-.15-2.23 1.66-4.07 3.74-4.25.29 2.58-2.34 4.5-3.74 4.25z"/>
            </svg>
          </button>
        </div>
      </div>
    </div>

    <!-- ==================== PAGE 2: REGISTER ==================== -->
    <div class="page" id="page-register">
      <!-- Status Bar -->
      <div class="status-bar">
        <span>9:41</span>
        <div class="flex items-center gap-1">
          <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24"><path d="M12 3C7.5 3 4 5.5 4 9c0 5 8 12 8 12s8-7 8-12c0-3.5-3.5-6-8-6zm0 2c2.8 0 5 1.8 5 4 0 1.5-1 3.5-3 5.7L12 17l-2-2.3C8 12.5 7 10.5 7 9c0-2.2 2.2-4 5-4z"/></svg>
          <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24"><path d="M1 9l2 2c4.97-4.97 13.03-4.97 18 0l2-2C16.93 2.93 7.08 2.93 1 9zm8 8l3 3 3-3c-1.65-1.66-4.34-1.66-6 0zm-4-4l2 2c2.76-2.76 7.24-2.76 10 0l2-2C15.14 9.14 8.87 9.14 5 13z"/></svg>
          <svg class="w-6 h-4" fill="currentColor" viewBox="0 0 24 24"><rect x="2" y="7" width="18" height="10" rx="2" stroke="currentColor" stroke-width="2" fill="none"/><rect x="20" y="10" width="2" height="4" rx="1"/><rect x="4" y="9" width="12" height="6" rx="1"/></svg>
        </div>
      </div>

      <!-- Back Button & Title -->
      <div class="px-6 pt-4 flex items-center gap-4">
        <button class="back-btn" onclick="showPage('page-login')">
          <svg class="w-5 h-5 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
          </svg>
        </button>
        <h2 class="text-lg font-semibold text-gray-800">Create Account</h2>
      </div>

      <!-- Header -->
      <div class="px-6 pt-6 pb-4">
        <div class="flex flex-col items-center">
          <div class="logo-cloud mb-3">
            <svg width="48" height="36" viewBox="0 0 64 48" fill="none">
              <path d="M52 24C52 13.5 43.5 5 33 5C24.5 5 17.5 10.5 15 18C7 19 1 25.5 1 33.5C1 42 8 48 16.5 48H50C57.5 48 63 42.5 63 35C63 28 58 22.5 52 24Z" fill="white" stroke="#4A90E2" stroke-width="2"/>
            </svg>
          </div>
          <p class="text-gray-500 text-sm text-center">Join DeyeSmart and start your smart life journey</p>
        </div>
      </div>

      <!-- Auth Card -->
      <div class="auth-card absolute bottom-0 left-0 right-0 px-6 pt-6 pb-8" style="max-height: 65%;">
        <div class="overflow-y-auto h-full pr-1">
          <!-- Form -->
          <div class="space-y-4">
            <!-- Email Input -->
            <div class="input-wrapper">
              <label class="text-sm text-gray-600 mb-1 block">Email</label>
              <input type="email" class="input-field" placeholder="Enter your email" id="register-email" onblur="validateEmailField('register-email')">
              <div id="register-email-error"></div>
            </div>

            <!-- Password Input -->
            <div class="input-wrapper">
              <label class="text-sm text-gray-600 mb-1 block">Password</label>
              <div class="relative">
                <input type="password" class="input-field pr-12" placeholder="Create a password" id="register-password" oninput="checkPasswordStrengthEnhanced(this.value, 'register')">
                <button class="absolute right-4 top-1/2 -translate-y-1/2 text-gray-400" onclick="togglePassword('register-password', this)">
                  <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/>
                  </svg>
                </button>
              </div>
              <!-- Password Rules -->
              <div class="password-rules" id="register-password-rules">
                <div class="password-rule" id="rule-length">
                  <span class="rule-icon"><svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"/></svg></span>
                  <span>At least 8 characters</span>
                </div>
                <div class="password-rule" id="rule-upper">
                  <span class="rule-icon"><svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"/></svg></span>
                  <span>One uppercase letter</span>
                </div>
                <div class="password-rule" id="rule-lower">
                  <span class="rule-icon"><svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"/></svg></span>
                  <span>One lowercase letter</span>
                </div>
                <div class="password-rule" id="rule-number">
                  <span class="rule-icon"><svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"/></svg></span>
                  <span>One number</span>
                </div>
              </div>
            </div>

            <!-- Confirm Password -->
            <div class="input-wrapper">
              <label class="text-sm text-gray-600 mb-1 block">Confirm Password</label>
              <div class="relative">
                <input type="password" class="input-field pr-12" placeholder="Confirm your password" id="register-confirm" oninput="checkPasswordMatch('register')">
                <button class="absolute right-4 top-1/2 -translate-y-1/2 text-gray-400" onclick="togglePassword('register-confirm', this)">
                  <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/>
                  </svg>
                </button>
              </div>
              <div id="register-confirm-hint"></div>
            </div>

            <!-- Agreement Checkbox -->
            <div class="flex items-start gap-3">
              <div class="custom-checkbox" id="register-agree" onclick="toggleCheckbox(this)">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                  <polyline points="20 6 9 17 4 12"></polyline>
                </svg>
              </div>
              <p class="text-xs text-gray-500 leading-relaxed">
                I have read and agree to the
                <a href="#" class="text-blue-500" onclick="showModal('terms-modal')">Terms of Service</a>
                and
                <a href="#" class="text-blue-500" onclick="showModal('privacy-modal')">Privacy Policy</a>
              </p>
            </div>

            <!-- Register Button -->
            <button class="btn-primary" onclick="handleRegister()">Create Account</button>

            <!-- Login Link -->
            <p class="text-center text-sm text-gray-500">
              Already have an account?
              <a href="#" class="text-blue-500 font-medium" onclick="showPage('page-login')">Sign In</a>
            </p>
          </div>

          <!-- Social Login Divider -->
          <div class="flex items-center gap-4 my-5">
            <div class="flex-1 h-px bg-gray-200"></div>
            <span class="text-xs text-gray-400">or sign up with</span>
            <div class="flex-1 h-px bg-gray-200"></div>
          </div>

          <!-- Social Buttons -->
          <div class="flex justify-center pb-4">
            <button class="social-btn" onclick="handleSocialLogin('Apple')">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="#000">
                <path d="M17.05 20.28c-.98.95-2.05.8-3.08.35-1.09-.46-2.09-.48-3.24 0-1.44.62-2.2.44-3.06-.35C2.79 15.25 3.51 7.59 9.05 7.31c1.35.07 2.29.74 3.08.8 1.18-.24 2.31-.93 3.57-.84 1.51.12 2.65.72 3.4 1.8-3.12 1.87-2.38 5.98.48 7.13-.57 1.5-1.31 2.99-2.54 4.09l.01-.01zM12.03 7.25c-.15-2.23 1.66-4.07 3.74-4.25.29 2.58-2.34 4.5-3.74 4.25z"/>
              </svg>
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- ==================== PAGE 3: EMAIL VERIFICATION ==================== -->
    <div class="page" id="page-verify">
      <!-- Status Bar -->
      <div class="status-bar">
        <span>9:41</span>
        <div class="flex items-center gap-1">
          <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24"><path d="M12 3C7.5 3 4 5.5 4 9c0 5 8 12 8 12s8-7 8-12c0-3.5-3.5-6-8-6zm0 2c2.8 0 5 1.8 5 4 0 1.5-1 3.5-3 5.7L12 17l-2-2.3C8 12.5 7 10.5 7 9c0-2.2 2.2-4 5-4z"/></svg>
          <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24"><path d="M1 9l2 2c4.97-4.97 13.03-4.97 18 0l2-2C16.93 2.93 7.08 2.93 1 9zm8 8l3 3 3-3c-1.65-1.66-4.34-1.66-6 0zm-4-4l2 2c2.76-2.76 7.24-2.76 10 0l2-2C15.14 9.14 8.87 9.14 5 13z"/></svg>
          <svg class="w-6 h-4" fill="currentColor" viewBox="0 0 24 24"><rect x="2" y="7" width="18" height="10" rx="2" stroke="currentColor" stroke-width="2" fill="none"/><rect x="20" y="10" width="2" height="4" rx="1"/><rect x="4" y="9" width="12" height="6" rx="1"/></svg>
        </div>
      </div>

      <!-- Back Button & Title -->
      <div class="px-6 pt-4 flex items-center gap-4">
        <button class="back-btn" onclick="showPage('page-register')">
          <svg class="w-5 h-5 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
          </svg>
        </button>
        <h2 class="text-lg font-semibold text-gray-800">Verify Email</h2>
      </div>

      <!-- Content -->
      <div class="px-6 pt-16 flex flex-col items-center">
        <!-- Email Icon -->
        <div class="w-20 h-20 bg-blue-50 rounded-full flex items-center justify-center mb-6">
          <svg class="w-10 h-10 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/>
          </svg>
        </div>

        <h3 class="text-xl font-semibold text-gray-800 mb-2">Check your email</h3>
        <p class="text-gray-500 text-sm text-center mb-8">
          We've sent a verification code to<br>
          <span class="text-gray-800 font-medium" id="verify-email">user@example.com</span>
        </p>

        <!-- Code Input -->
        <div class="code-input-wrapper">
          <div class="flex gap-3 mb-2" id="verify-code-inputs">
            <input type="text" maxlength="1" class="code-input verify-code" onkeydown="handleCodeKeydown(event, this, 'verify')" oninput="handleCodeInput(this, 'verify')" data-index="0">
            <input type="text" maxlength="1" class="code-input verify-code" onkeydown="handleCodeKeydown(event, this, 'verify')" oninput="handleCodeInput(this, 'verify')" data-index="1">
            <input type="text" maxlength="1" class="code-input verify-code" onkeydown="handleCodeKeydown(event, this, 'verify')" oninput="handleCodeInput(this, 'verify')" data-index="2">
            <input type="text" maxlength="1" class="code-input verify-code" onkeydown="handleCodeKeydown(event, this, 'verify')" oninput="handleCodeInput(this, 'verify')" data-index="3">
            <input type="text" maxlength="1" class="code-input verify-code" onkeydown="handleCodeKeydown(event, this, 'verify')" oninput="handleCodeInput(this, 'verify')" data-index="4">
            <input type="text" maxlength="1" class="code-input verify-code" onkeydown="handleCodeKeydown(event, this, 'verify')" oninput="handleCodeInput(this, 'verify')" data-index="5">
          </div>
          <div id="verify-code-error" class="text-center"></div>
        </div>

        <!-- Resend -->
        <p class="text-sm text-gray-500 mb-8">
          Didn't receive the code?
          <button class="text-blue-500 font-medium" id="resend-btn" onclick="resendCode()">Resend</button>
          <span id="resend-timer" class="text-gray-400 hidden">(60s)</span>
        </p>

        <!-- Verify Button -->
        <button class="btn-primary w-full max-w-xs" onclick="handleVerify()">Verify Email</button>
      </div>
    </div>

    <!-- ==================== PAGE 4: FORGOT PASSWORD ==================== -->
    <div class="page" id="page-forgot">
      <!-- Status Bar -->
      <div class="status-bar">
        <span>9:41</span>
        <div class="flex items-center gap-1">
          <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24"><path d="M12 3C7.5 3 4 5.5 4 9c0 5 8 12 8 12s8-7 8-12c0-3.5-3.5-6-8-6zm0 2c2.8 0 5 1.8 5 4 0 1.5-1 3.5-3 5.7L12 17l-2-2.3C8 12.5 7 10.5 7 9c0-2.2 2.2-4 5-4z"/></svg>
          <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24"><path d="M1 9l2 2c4.97-4.97 13.03-4.97 18 0l2-2C16.93 2.93 7.08 2.93 1 9zm8 8l3 3 3-3c-1.65-1.66-4.34-1.66-6 0zm-4-4l2 2c2.76-2.76 7.24-2.76 10 0l2-2C15.14 9.14 8.87 9.14 5 13z"/></svg>
          <svg class="w-6 h-4" fill="currentColor" viewBox="0 0 24 24"><rect x="2" y="7" width="18" height="10" rx="2" stroke="currentColor" stroke-width="2" fill="none"/><rect x="20" y="10" width="2" height="4" rx="1"/><rect x="4" y="9" width="12" height="6" rx="1"/></svg>
        </div>
      </div>

      <!-- Back Button & Title -->
      <div class="px-6 pt-4 flex items-center gap-4">
        <button class="back-btn" onclick="showPage('page-login')">
          <svg class="w-5 h-5 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
          </svg>
        </button>
        <h2 class="text-lg font-semibold text-gray-800">Forgot Password</h2>
      </div>

      <!-- Content -->
      <div class="px-6 pt-16 flex flex-col items-center">
        <!-- Lock Icon -->
        <div class="w-20 h-20 bg-blue-50 rounded-full flex items-center justify-center mb-6">
          <svg class="w-10 h-10 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"/>
          </svg>
        </div>

        <h3 class="text-xl font-semibold text-gray-800 mb-2">Reset your password</h3>
        <p class="text-gray-500 text-sm text-center mb-8">
          Enter your email address and we'll send you<br>a verification code.
        </p>

        <!-- Email Input -->
        <div class="w-full max-w-xs mb-6 input-wrapper">
          <input type="email" class="input-field" placeholder="Email address" id="forgot-email" onblur="validateEmailField('forgot-email')">
          <div id="forgot-email-error"></div>
        </div>

        <!-- Send Button -->
        <button class="btn-primary w-full max-w-xs" onclick="handleForgotPassword()">Send Code</button>

        <!-- Back to Login -->
        <p class="text-sm text-gray-500 mt-6">
          Remember your password?
          <a href="#" class="text-blue-500 font-medium" onclick="showPage('page-login')">Sign In</a>
        </p>
      </div>
    </div>

    <!-- ==================== PAGE 4.1: ENTER VERIFICATION CODE ==================== -->
    <div class="page" id="page-link-sent">
      <!-- Status Bar -->
      <div class="status-bar">
        <span>9:41</span>
        <div class="flex items-center gap-1">
          <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24"><path d="M12 3C7.5 3 4 5.5 4 9c0 5 8 12 8 12s8-7 8-12c0-3.5-3.5-6-8-6zm0 2c2.8 0 5 1.8 5 4 0 1.5-1 3.5-3 5.7L12 17l-2-2.3C8 12.5 7 10.5 7 9c0-2.2 2.2-4 5-4z"/></svg>
          <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24"><path d="M1 9l2 2c4.97-4.97 13.03-4.97 18 0l2-2C16.93 2.93 7.08 2.93 1 9zm8 8l3 3 3-3c-1.65-1.66-4.34-1.66-6 0zm-4-4l2 2c2.76-2.76 7.24-2.76 10 0l2-2C15.14 9.14 8.87 9.14 5 13z"/></svg>
          <svg class="w-6 h-4" fill="currentColor" viewBox="0 0 24 24"><rect x="2" y="7" width="18" height="10" rx="2" stroke="currentColor" stroke-width="2" fill="none"/><rect x="20" y="10" width="2" height="4" rx="1"/><rect x="4" y="9" width="12" height="6" rx="1"/></svg>
        </div>
      </div>

      <!-- Back Button & Title -->
      <div class="px-6 pt-4 flex items-center gap-4">
        <button class="back-btn" onclick="showPage('page-forgot')">
          <svg class="w-5 h-5 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
          </svg>
        </button>
        <h2 class="text-lg font-semibold text-gray-800">Verify Code</h2>
      </div>

      <!-- Content -->
      <div class="px-6 pt-16 flex flex-col items-center">
        <!-- Email Icon -->
        <div class="w-20 h-20 bg-blue-50 rounded-full flex items-center justify-center mb-6">
          <svg class="w-10 h-10 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/>
          </svg>
        </div>

        <h3 class="text-xl font-semibold text-gray-800 mb-2">Enter verification code</h3>
        <p class="text-gray-500 text-sm text-center mb-2">
          We've sent a verification code to
        </p>
        <p class="text-gray-800 font-medium text-center mb-8" id="sent-email">
          u***@example.com
        </p>

        <!-- Code Input -->
        <div class="code-input-wrapper">
          <div class="flex gap-3 mb-2" id="reset-code-inputs">
            <input type="text" maxlength="1" class="code-input reset-code-input" onkeydown="handleCodeKeydown(event, this, 'reset')" oninput="handleCodeInput(this, 'reset')" data-index="0">
            <input type="text" maxlength="1" class="code-input reset-code-input" onkeydown="handleCodeKeydown(event, this, 'reset')" oninput="handleCodeInput(this, 'reset')" data-index="1">
            <input type="text" maxlength="1" class="code-input reset-code-input" onkeydown="handleCodeKeydown(event, this, 'reset')" oninput="handleCodeInput(this, 'reset')" data-index="2">
            <input type="text" maxlength="1" class="code-input reset-code-input" onkeydown="handleCodeKeydown(event, this, 'reset')" oninput="handleCodeInput(this, 'reset')" data-index="3">
            <input type="text" maxlength="1" class="code-input reset-code-input" onkeydown="handleCodeKeydown(event, this, 'reset')" oninput="handleCodeInput(this, 'reset')" data-index="4">
            <input type="text" maxlength="1" class="code-input reset-code-input" onkeydown="handleCodeKeydown(event, this, 'reset')" oninput="handleCodeInput(this, 'reset')" data-index="5">
          </div>
          <div id="reset-code-error" class="text-center"></div>
        </div>

        <!-- Resend Code -->
        <p class="text-sm text-gray-500 mb-8">
          Didn't receive the code?
          <button class="text-blue-500 font-medium" id="resend-reset-btn" onclick="resendResetCode()">Resend</button>
          <span id="resend-reset-timer" class="text-gray-400 hidden">(60s)</span>
        </p>

        <!-- Verify Button -->
        <button class="btn-primary w-full max-w-xs" onclick="handleVerifyResetCode()">Verify</button>

        <!-- Back to Login -->
        <p class="text-sm text-gray-500 mt-8">
          <a href="#" class="text-blue-500 font-medium" onclick="showPage('page-login')">← Back to Sign In</a>
        </p>
      </div>
    </div>

    <!-- ==================== PAGE 5: RESET PASSWORD ==================== -->
    <div class="page" id="page-reset">
      <!-- Status Bar -->
      <div class="status-bar">
        <span>9:41</span>
        <div class="flex items-center gap-1">
          <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24"><path d="M12 3C7.5 3 4 5.5 4 9c0 5 8 12 8 12s8-7 8-12c0-3.5-3.5-6-8-6zm0 2c2.8 0 5 1.8 5 4 0 1.5-1 3.5-3 5.7L12 17l-2-2.3C8 12.5 7 10.5 7 9c0-2.2 2.2-4 5-4z"/></svg>
          <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24"><path d="M1 9l2 2c4.97-4.97 13.03-4.97 18 0l2-2C16.93 2.93 7.08 2.93 1 9zm8 8l3 3 3-3c-1.65-1.66-4.34-1.66-6 0zm-4-4l2 2c2.76-2.76 7.24-2.76 10 0l2-2C15.14 9.14 8.87 9.14 5 13z"/></svg>
          <svg class="w-6 h-4" fill="currentColor" viewBox="0 0 24 24"><rect x="2" y="7" width="18" height="10" rx="2" stroke="currentColor" stroke-width="2" fill="none"/><rect x="20" y="10" width="2" height="4" rx="1"/><rect x="4" y="9" width="12" height="6" rx="1"/></svg>
        </div>
      </div>

      <!-- Back Button & Title -->
      <div class="px-6 pt-4 flex items-center gap-4">
        <button class="back-btn" onclick="showPage('page-forgot')">
          <svg class="w-5 h-5 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
          </svg>
        </button>
        <h2 class="text-lg font-semibold text-gray-800">Reset Password</h2>
      </div>

      <!-- Content -->
      <div class="px-6 pt-12 flex flex-col items-center">
        <!-- Key Icon -->
        <div class="w-20 h-20 bg-green-50 rounded-full flex items-center justify-center mb-6">
          <svg class="w-10 h-10 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"/>
          </svg>
        </div>

        <h3 class="text-xl font-semibold text-gray-800 mb-2">Create new password</h3>
        <p class="text-gray-500 text-sm text-center mb-8">
          Your new password must be different<br>from previous used passwords.
        </p>

        <!-- Password Fields -->
        <div class="w-full max-w-xs space-y-4">
          <div class="input-wrapper">
            <label class="text-sm text-gray-600 mb-1 block">New Password</label>
            <div class="relative">
              <input type="password" class="input-field pr-12" placeholder="Enter new password" id="reset-password" oninput="checkPasswordStrengthEnhanced(this.value, 'reset')">
              <button class="absolute right-4 top-1/2 -translate-y-1/2 text-gray-400" onclick="togglePassword('reset-password', this)">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/>
                </svg>
              </button>
            </div>
            <!-- Password Rules for Reset -->
            <div class="password-rules" id="reset-password-rules">
              <div class="password-rule" id="reset-rule-length">
                <span class="rule-icon"><svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"/></svg></span>
                <span>At least 8 characters</span>
              </div>
              <div class="password-rule" id="reset-rule-upper">
                <span class="rule-icon"><svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"/></svg></span>
                <span>One uppercase letter</span>
              </div>
              <div class="password-rule" id="reset-rule-lower">
                <span class="rule-icon"><svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"/></svg></span>
                <span>One lowercase letter</span>
              </div>
              <div class="password-rule" id="reset-rule-number">
                <span class="rule-icon"><svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"/></svg></span>
                <span>One number</span>
              </div>
            </div>
          </div>

          <div class="input-wrapper">
            <label class="text-sm text-gray-600 mb-1 block">Confirm New Password</label>
            <div class="relative">
              <input type="password" class="input-field pr-12" placeholder="Confirm new password" id="reset-confirm" oninput="checkPasswordMatch('reset')">
              <button class="absolute right-4 top-1/2 -translate-y-1/2 text-gray-400" onclick="togglePassword('reset-confirm', this)">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/>
                </svg>
              </button>
            </div>
            <div id="reset-confirm-hint"></div>
          </div>

          <!-- Reset Button -->
          <button class="btn-primary w-full mt-4" onclick="handleResetPassword()">Reset Password</button>
        </div>
      </div>
    </div>

    <!-- ==================== PAGE 6: SUCCESS ==================== -->
    <div class="page" id="page-success">
      <!-- Status Bar -->
      <div class="status-bar">
        <span>9:41</span>
        <div class="flex items-center gap-1">
          <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24"><path d="M12 3C7.5 3 4 5.5 4 9c0 5 8 12 8 12s8-7 8-12c0-3.5-3.5-6-8-6zm0 2c2.8 0 5 1.8 5 4 0 1.5-1 3.5-3 5.7L12 17l-2-2.3C8 12.5 7 10.5 7 9c0-2.2 2.2-4 5-4z"/></svg>
          <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24"><path d="M1 9l2 2c4.97-4.97 13.03-4.97 18 0l2-2C16.93 2.93 7.08 2.93 1 9zm8 8l3 3 3-3c-1.65-1.66-4.34-1.66-6 0zm-4-4l2 2c2.76-2.76 7.24-2.76 10 0l2-2C15.14 9.14 8.87 9.14 5 13z"/></svg>
          <svg class="w-6 h-4" fill="currentColor" viewBox="0 0 24 24"><rect x="2" y="7" width="18" height="10" rx="2" stroke="currentColor" stroke-width="2" fill="none"/><rect x="20" y="10" width="2" height="4" rx="1"/><rect x="4" y="9" width="12" height="6" rx="1"/></svg>
        </div>
      </div>

      <!-- Content -->
      <div class="px-6 pt-32 flex flex-col items-center">
        <!-- Success Icon -->
        <div class="w-24 h-24 bg-green-100 rounded-full flex items-center justify-center mb-6 animate-bounce">
          <svg class="w-12 h-12 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
          </svg>
        </div>

        <h3 class="text-2xl font-semibold text-gray-800 mb-2" id="success-title">Success!</h3>
        <p class="text-gray-500 text-sm text-center mb-8" id="success-message">
          Your account has been created successfully.
        </p>

        <!-- Continue Button -->
        <button class="btn-primary w-full max-w-xs" onclick="showPage('page-login')">Continue to Sign In</button>
      </div>
    </div>

    <!-- ==================== MODAL: TERMS OF SERVICE ==================== -->
    <div class="modal-overlay" id="terms-modal" onclick="hideModal('terms-modal')">
      <div class="modal-content" onclick="event.stopPropagation()">
        <!-- Header -->
        <div class="flex items-center justify-between p-4 border-b">
          <h3 class="text-lg font-semibold text-gray-800">Terms of Service</h3>
          <button class="text-gray-400 hover:text-gray-600" onclick="hideModal('terms-modal')">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
            </svg>
          </button>
        </div>
        <!-- Content -->
        <div class="p-4 overflow-y-auto" style="max-height: 400px;">
          <div class="text-sm text-gray-600 space-y-4">
            <p class="font-medium text-gray-800">Last Updated: December 2024</p>

            <h4 class="font-semibold text-gray-800">1. Acceptance of Terms</h4>
            <p>By accessing and using DeyeSmart services, you agree to be bound by these Terms of Service and all applicable laws and regulations.</p>

            <h4 class="font-semibold text-gray-800">2. Use License</h4>
            <p>Permission is granted to temporarily use the DeyeSmart application for personal, non-commercial transitory viewing only.</p>

            <h4 class="font-semibold text-gray-800">3. User Account</h4>
            <p>You are responsible for maintaining the confidentiality of your account and password and for restricting access to your devices.</p>

            <h4 class="font-semibold text-gray-800">4. Privacy</h4>
            <p>Your use of DeyeSmart is also governed by our Privacy Policy. Please review our Privacy Policy to understand our practices.</p>

            <h4 class="font-semibold text-gray-800">5. Modifications</h4>
            <p>DeyeSmart reserves the right to modify these terms at any time. We will notify you of any changes by posting the new Terms of Service on this page.</p>

            <h4 class="font-semibold text-gray-800">6. Contact Information</h4>
            <p>If you have any questions about these Terms, please contact us at support@deyesmart.com</p>
          </div>
        </div>
        <!-- Footer -->
        <div class="p-4 border-t">
          <button class="btn-primary" onclick="hideModal('terms-modal')">I Understand</button>
        </div>
      </div>
    </div>

    <!-- ==================== MODAL: PRIVACY POLICY ==================== -->
    <div class="modal-overlay" id="privacy-modal" onclick="hideModal('privacy-modal')">
      <div class="modal-content" onclick="event.stopPropagation()">
        <!-- Header -->
        <div class="flex items-center justify-between p-4 border-b">
          <h3 class="text-lg font-semibold text-gray-800">Privacy Policy</h3>
          <button class="text-gray-400 hover:text-gray-600" onclick="hideModal('privacy-modal')">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
            </svg>
          </button>
        </div>
        <!-- Content -->
        <div class="p-4 overflow-y-auto" style="max-height: 400px;">
          <div class="text-sm text-gray-600 space-y-4">
            <p class="font-medium text-gray-800">Last Updated: December 2024</p>

            <h4 class="font-semibold text-gray-800">1. Information We Collect</h4>
            <p>We collect information you provide directly to us, such as when you create an account, make a purchase, or contact us for support.</p>

            <h4 class="font-semibold text-gray-800">2. How We Use Your Information</h4>
            <p>We use the information we collect to provide, maintain, and improve our services, process transactions, and communicate with you.</p>

            <h4 class="font-semibold text-gray-800">3. Information Sharing</h4>
            <p>We do not share your personal information with third parties except as described in this policy or with your consent.</p>

            <h4 class="font-semibold text-gray-800">4. Data Security</h4>
            <p>We implement appropriate technical and organizational measures to protect your personal information against unauthorized access.</p>

            <h4 class="font-semibold text-gray-800">5. Your Rights</h4>
            <p>You have the right to access, correct, or delete your personal information. You may also object to or restrict certain processing of your information.</p>

            <h4 class="font-semibold text-gray-800">6. Contact Us</h4>
            <p>If you have any questions about this Privacy Policy, please contact us at privacy@deyesmart.com</p>
          </div>
        </div>
        <!-- Footer -->
        <div class="p-4 border-t">
          <button class="btn-primary" onclick="hideModal('privacy-modal')">I Understand</button>
        </div>
      </div>
    </div>

  </div>

  <!-- JavaScript -->
  <script>
    // ==================== Toast 提示系统 ====================
    function showToast(message, type = 'info') {
      const container = document.getElementById('toast-container');
      const icons = {
        success: '<svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>',
        error: '<svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>',
        warning: '<svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/></svg>',
        info: '<svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>'
      };

      const toast = document.createElement('div');
      toast.className = `toast ${type}`;
      toast.innerHTML = `${icons[type]}<span>${message}</span>`;
      container.appendChild(toast);

      // Trigger animation
      requestAnimationFrame(() => {
        toast.classList.add('show');
      });

      // Remove after 3 seconds
      setTimeout(() => {
        toast.classList.remove('show');
        toast.classList.add('hide');
        setTimeout(() => toast.remove(), 300);
      }, 3000);
    }

    // ==================== 邮箱验证 ====================
    function validateEmail(email) {
      const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      return re.test(email);
    }

    function validateEmailField(inputId) {
      const input = document.getElementById(inputId);
      const errorDiv = document.getElementById(`${inputId}-error`);
      const email = input.value.trim();

      if (!email) {
        input.classList.remove('error', 'success');
        errorDiv.innerHTML = '';
        return false;
      }

      if (!validateEmail(email)) {
        input.classList.add('error');
        input.classList.remove('success');
        errorDiv.innerHTML = `
          <div class="error-message">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
            <span>Please enter a valid email address</span>
          </div>
        `;
        return false;
      } else {
        input.classList.remove('error');
        input.classList.add('success');
        errorDiv.innerHTML = '';
        return true;
      }
    }

    // ==================== 密码强度验证 (增强版) ====================
    function checkPasswordStrengthEnhanced(password, type = 'register') {
      const prefix = type === 'reset' ? 'reset-' : '';
      const rules = {
        length: password.length >= 8,
        upper: /[A-Z]/.test(password),
        lower: /[a-z]/.test(password),
        number: /[0-9]/.test(password)
      };

      // Update rule indicators
      Object.keys(rules).forEach(rule => {
        const ruleEl = document.getElementById(`${prefix}rule-${rule}`);
        if (ruleEl) {
          if (rules[rule]) {
            ruleEl.classList.add('valid');
          } else {
            ruleEl.classList.remove('valid');
          }
        }
      });

      // Check confirm password match if exists
      checkPasswordMatch(type);
    }

    // ==================== 密码匹配检测 ====================
    function checkPasswordMatch(type = 'register') {
      const passwordId = type === 'reset' ? 'reset-password' : 'register-password';
      const confirmId = type === 'reset' ? 'reset-confirm' : 'register-confirm';
      const hintId = type === 'reset' ? 'reset-confirm-hint' : 'register-confirm-hint';

      const password = document.getElementById(passwordId).value;
      const confirm = document.getElementById(confirmId).value;
      const hintDiv = document.getElementById(hintId);
      const confirmInput = document.getElementById(confirmId);

      if (!confirm) {
        hintDiv.innerHTML = '';
        confirmInput.classList.remove('error', 'success');
        return;
      }

      if (password === confirm) {
        hintDiv.innerHTML = `
          <div class="password-match-hint match">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg>
            <span>Passwords match</span>
          </div>
        `;
        confirmInput.classList.remove('error');
        confirmInput.classList.add('success');
      } else {
        hintDiv.innerHTML = `
          <div class="password-match-hint mismatch">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg>
            <span>Passwords do not match</span>
          </div>
        `;
        confirmInput.classList.add('error');
        confirmInput.classList.remove('success');
      }
    }

    // ==================== 验证码输入处理 ====================
    function handleCodeKeydown(event, input, type) {
      const inputs = document.querySelectorAll(type === 'reset' ? '.reset-code-input' : '.verify-code');
      const index = parseInt(input.dataset.index);

      // Handle backspace
      if (event.key === 'Backspace') {
        if (!input.value && index > 0) {
          inputs[index - 1].focus();
          inputs[index - 1].value = '';
        }
      }

      // Handle paste
      if (event.key === 'v' && (event.ctrlKey || event.metaKey)) {
        event.preventDefault();
        navigator.clipboard.readText().then(text => {
          const code = text.replace(/\D/g, '').slice(0, 6);
          code.split('').forEach((char, i) => {
            if (inputs[i]) {
              inputs[i].value = char;
            }
          });
          if (code.length === 6) {
            inputs[5].focus();
          }
        });
      }

      // Handle left/right arrow keys
      if (event.key === 'ArrowLeft' && index > 0) {
        inputs[index - 1].focus();
      }
      if (event.key === 'ArrowRight' && index < 5) {
        inputs[index + 1].focus();
      }
    }

    function handleCodeInput(input, type) {
      const inputs = document.querySelectorAll(type === 'reset' ? '.reset-code-input' : '.verify-code');
      const index = parseInt(input.dataset.index);

      // Only allow numbers
      input.value = input.value.replace(/\D/g, '');

      // Move to next input
      if (input.value && index < 5) {
        inputs[index + 1].focus();
      }

      // Clear error state when typing
      clearCodeError(type);
    }

    function showCodeError(type, message) {
      const errorDiv = document.getElementById(`${type === 'reset' ? 'reset' : 'verify'}-code-error`);
      const inputs = document.querySelectorAll(type === 'reset' ? '.reset-code-input' : '.verify-code');

      errorDiv.innerHTML = `<div class="error-message" style="justify-content: center; margin-top: 8px;">
        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
        <span>${message}</span>
      </div>`;

      // Add error class to all inputs for shake animation
      inputs.forEach(input => {
        input.classList.add('error');
        // Remove error class after animation
        setTimeout(() => input.classList.remove('error'), 600);
      });
    }

    function clearCodeError(type) {
      const errorDiv = document.getElementById(`${type === 'reset' ? 'reset' : 'verify'}-code-error`);
      errorDiv.innerHTML = '';
    }

    function getCodeValue(type) {
      const inputs = document.querySelectorAll(type === 'reset' ? '.reset-code-input' : '.verify-code');
      let code = '';
      inputs.forEach(input => code += input.value);
      return code;
    }

    // ==================== 忘记密码 - 自动带入邮箱 ====================
    function goToForgotPassword() {
      const loginEmail = document.getElementById('login-email').value.trim();
      const forgotEmailInput = document.getElementById('forgot-email');

      if (loginEmail) {
        forgotEmailInput.value = loginEmail;
      }

      showPage('page-forgot');
    }

    // ==================== Page navigation ====================
    function showPage(pageId) {
      document.querySelectorAll('.page').forEach(page => {
        page.classList.remove('active');
      });
      document.getElementById(pageId).classList.add('active');
    }

    // ==================== Toggle password visibility ====================
    function togglePassword(inputId, button) {
      const input = document.getElementById(inputId);
      const isPassword = input.type === 'password';
      input.type = isPassword ? 'text' : 'password';

      button.innerHTML = isPassword ?
        `<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"/>
        </svg>` :
        `<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/>
        </svg>`;
    }

    // ==================== Toggle checkbox ====================
    function toggleCheckbox(checkbox) {
      checkbox.classList.toggle('checked');
    }

    // ==================== Resend code with timer ====================
    let resendTimer = null;
    function resendCode() {
      const btn = document.getElementById('resend-btn');
      const timer = document.getElementById('resend-timer');

      btn.classList.add('hidden');
      timer.classList.remove('hidden');

      let seconds = 60;
      resendTimer = setInterval(() => {
        seconds--;
        timer.textContent = `(${seconds}s)`;

        if (seconds <= 0) {
          clearInterval(resendTimer);
          btn.classList.remove('hidden');
          timer.classList.add('hidden');
          timer.textContent = '(60s)';
        }
      }, 1000);

      showToast('A new code has been sent to your email', 'success');
    }

    let resendResetTimer = null;
    function resendResetCode() {
      const btn = document.getElementById('resend-reset-btn');
      const timer = document.getElementById('resend-reset-timer');

      btn.classList.add('hidden');
      timer.classList.remove('hidden');

      let seconds = 60;
      resendResetTimer = setInterval(() => {
        seconds--;
        timer.textContent = `(${seconds}s)`;

        if (seconds <= 0) {
          clearInterval(resendResetTimer);
          btn.classList.remove('hidden');
          timer.classList.add('hidden');
          timer.textContent = '(60s)';
        }
      }, 1000);

      showToast('A new code has been sent to your email', 'success');
    }

    // ==================== Modal handling ====================
    function showModal(modalId) {
      document.getElementById(modalId).classList.add('active');
    }

    function hideModal(modalId) {
      document.getElementById(modalId).classList.remove('active');
    }

    // ==================== Form handlers ====================
    function handleLogin() {
      const email = document.getElementById('login-email').value.trim();
      const password = document.getElementById('login-password').value;
      const agree = document.getElementById('login-agree').classList.contains('checked');

      // Validate email
      if (!email) {
        showToast('Please enter your email address', 'error');
        document.getElementById('login-email').focus();
        return;
      }

      if (!validateEmail(email)) {
        validateEmailField('login-email');
        showToast('Please enter a valid email address', 'error');
        return;
      }

      if (!password) {
        showToast('Please enter your password', 'error');
        document.getElementById('login-password').focus();
        return;
      }

      if (!agree) {
        showToast('Please agree to the Terms of Service and Privacy Policy', 'warning');
        return;
      }

      // Simulate success
      document.getElementById('success-title').textContent = 'Welcome Back!';
      document.getElementById('success-message').textContent = 'You have successfully signed in to your account.';
      showPage('page-success');
    }

    function handleRegister() {
      const email = document.getElementById('register-email').value.trim();
      const password = document.getElementById('register-password').value;
      const confirm = document.getElementById('register-confirm').value;
      const agree = document.getElementById('register-agree').classList.contains('checked');

      // Validate email
      if (!email) {
        showToast('Please enter your email address', 'error');
        document.getElementById('register-email').focus();
        return;
      }

      if (!validateEmail(email)) {
        validateEmailField('register-email');
        showToast('Please enter a valid email address', 'error');
        return;
      }

      // Validate password strength
      if (password.length < 8) {
        showToast('Password must be at least 8 characters', 'error');
        document.getElementById('register-password').focus();
        return;
      }

      if (password !== confirm) {
        showToast('Passwords do not match', 'error');
        document.getElementById('register-confirm').focus();
        return;
      }

      if (!agree) {
        showToast('Please agree to the Terms of Service and Privacy Policy', 'warning');
        return;
      }

      // Show email in verification page
      document.getElementById('verify-email').textContent = email;
      showPage('page-verify');
    }

    function handleVerify() {
      const code = getCodeValue('verify');

      if (code.length === 0) {
        showCodeError('verify', 'Please enter the verification code');
        return;
      }

      if (code.length !== 6) {
        showCodeError('verify', 'Please enter all 6 digits');
        return;
      }

      // Simulate verification (for demo: 123456 is correct, others fail)
      if (code === '123456') {
        document.getElementById('success-title').textContent = 'Email Verified!';
        document.getElementById('success-message').textContent = 'Your email has been verified successfully. You can now sign in to your account.';
        showPage('page-success');
      } else if (code === '000000') {
        showCodeError('verify', 'Verification code has expired. Please request a new one');
      } else {
        showCodeError('verify', 'Invalid verification code. Please try again');
      }
    }

    function handleForgotPassword() {
      const email = document.getElementById('forgot-email').value.trim();

      if (!email) {
        showToast('Please enter your email address', 'error');
        document.getElementById('forgot-email').focus();
        return;
      }

      if (!validateEmail(email)) {
        validateEmailField('forgot-email');
        showToast('Please enter a valid email address', 'error');
        return;
      }

      // Mask email for display
      const atIndex = email.indexOf('@');
      const maskedEmail = email.charAt(0) + '***' + email.substring(atIndex);
      document.getElementById('sent-email').textContent = maskedEmail;

      showToast('Verification code sent to your email', 'success');
      showPage('page-link-sent');
    }

    function handleVerifyResetCode() {
      const code = getCodeValue('reset');

      if (code.length === 0) {
        showCodeError('reset', 'Please enter the verification code');
        return;
      }

      if (code.length !== 6) {
        showCodeError('reset', 'Please enter all 6 digits');
        return;
      }

      // Simulate verification
      if (code === '123456') {
        showPage('page-reset');
      } else if (code === '000000') {
        showCodeError('reset', 'Verification code has expired. Please request a new one');
      } else {
        showCodeError('reset', 'Invalid verification code. Please try again');
      }
    }

    function handleResetPassword() {
      const password = document.getElementById('reset-password').value;
      const confirm = document.getElementById('reset-confirm').value;

      if (!password) {
        showToast('Please enter your new password', 'error');
        document.getElementById('reset-password').focus();
        return;
      }

      if (password.length < 8) {
        showToast('Password must be at least 8 characters', 'error');
        document.getElementById('reset-password').focus();
        return;
      }

      if (!confirm) {
        showToast('Please confirm your new password', 'error');
        document.getElementById('reset-confirm').focus();
        return;
      }

      if (password !== confirm) {
        showToast('Passwords do not match', 'error');
        document.getElementById('reset-confirm').focus();
        return;
      }

      document.getElementById('success-title').textContent = 'Password Reset!';
      document.getElementById('success-message').textContent = 'Your password has been reset successfully. You can now sign in with your new password.';
      showPage('page-success');
    }

    function handleSocialLogin(provider) {
      document.getElementById('success-title').textContent = 'Welcome!';
      document.getElementById('success-message').textContent = `You have successfully signed in with ${provider}.`;
      showPage('page-success');
    }

    // ==================== 初始化 ====================
    document.addEventListener('DOMContentLoaded', function() {
      // Auto focus first code input when page becomes visible
      const observer = new MutationObserver((mutations) => {
        mutations.forEach((mutation) => {
          if (mutation.target.classList.contains('active')) {
            const pageId = mutation.target.id;
            if (pageId === 'page-verify') {
              setTimeout(() => document.querySelector('.verify-code')?.focus(), 100);
            } else if (pageId === 'page-link-sent') {
              setTimeout(() => document.querySelector('.reset-code-input')?.focus(), 100);
            }
          }
        });
      });

      document.querySelectorAll('.page').forEach(page => {
        observer.observe(page, { attributes: true, attributeFilter: ['class'] });
      });
    });
  </script>

</body>
</html>
